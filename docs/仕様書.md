# アプリケーション仕様書

## プロジェクト名

Emoji Generator (絵文字ジェネレーター)

## 1. ソフトウェア概要

SlackやDiscordなどのカスタム絵文字として利用可能な、テキストベースの絵文字を生成するWebアプリケーション。ユーザーはWebサイト上で任意のテキスト、フォント、色を選択します。生成ボタンを押すと、入力された設定がバックエンドAPIに送信され、サーバーサイドで画像が生成されます。ユーザーは生成された正方形のPNG画像をダウンロードできます。フロントエンドはAstroアイランド上で動作するReactコンポーネントによって構築されます。

## 2. 機能要件

### 2.1. フロントエンド (Astro + React)

主要なUIとインタラクションは、Astroアイランドとして読み込まれる単一のReactコンポーネント（例: `EmojiGenerator.tsx`）で実装します。

- **UIコンポーネント群:**
  - **テキスト入力フィールド:** 絵文字にしたいテキストを入力する `<textarea>`。
  - **フォント選択:** 事前に定義されたフォントリストから選択するUI。
  - **カラーピッカー:** `react-color` などのライブラリを利用した、視覚的な色選択UI。
  - **プレビューエリア:** バックエンドから取得した生成後の画像を表示する `<img>` タグ。
  - **生成・ダウンロードボタン:** APIリクエストをトリガーするボタン。
- **状態管理:**
  - `useState` フックを使用して、テキスト、選択フォント、色などのUIの状態を`EmojiGenerator.tsx`内で一元管理します。
- **インタラクション:**
  - 生成ボタンをクリックすると、現在の状態をJSONとしてまとめ、バックエンドAPIへ画像生成リクエストを送信します。
  - APIリクエスト中は、ボタンを非活性化しローディング状態（スピナー表示など）にします。
  - APIから画像データ（Base64文字列など）を受け取り、プレビューエリアの `<img>` タグの `src` を更新します。
  - ダウンロード機能もAPIからのレスポンスを基に実装します。

## 3\. 使用技術

### 3.1. フロントエンド

- **フレームワーク:** **Astro (v4以降)**
- **UIフレームワーク (アイランド):** **React**
- **スタイリング:** **Tailwind CSS**
- **状態管理:** **React標準フック (useState)**
- **アイコン:** `lucide-react` 等の軽量なアイコンライブラリ

### 3.2. バックエンド

- 既存のAPiサーバがあるので、それを使用する。

## 4\. ディレクトリ構成 (Astro / React 想定)

- **`/src`**
  - **`/components`**: UIを構成するReactコンポーネントを配置します。Astroアイランドの起点となる`EmojiGenerator.tsx`もここに含まれます。
  - **`/layouts`**: サイト全体の基本的なHTML構造を定義するレイアウトコンポーネントを配置します。
  - **`/lib`**: バックエンドAPIを呼び出すためのクライアント用TypeScriptコードなど、汎用的なロジックを配置します。
  - **`/pages`**:
    - **`/api`**: バックエンドAPIのエンドポイントとなるファイル (`generate-emoji.ts`など) を配置します。
    - このディレクトリ直下に、ユーザーがアクセスするWebページ (`index.astro`など) を配置します。

## 5\. コーディングルール

- **TypeScript:** `any` 型の使用は原則禁止します。
- **Astro/React:** UIのインタラクティブな部分はすべてReactコンポーネントに集約し、Astroページからは `<EmojiGenerator client:load />` のようにアイランドとして呼び出します。
- **Lint/Formatter:** ESLintとPrettierを導入し、コードスタイルを統一します。

## 6\. 開発タスクのステップ案

1. **環境構築:**
      - `npm create astro@latest` でAstroプロジェクトを作成します。
      - `npx astro add react` と `npx astro add tailwind` を実行します。
2. **バックエンドAPIの実装:**
      - `src/pages/api/generate-emoji.ts` を作成します。
      - POSTリクエストを受け取り、画像処理ライブラリを使って画像を生成し、Base64文字列として返すロジックを実装します。
3. **フロントエンドUIの実装:**
      - `src/components/EmojiGenerator.tsx` を作成し、ReactとTailwind CSSでUIコンポーネントを構築します。`useState`で状態管理も行います。
      - `src/pages/index.astro` で、作成したReactコンポーネントをアイランドとして読み込みます。
4. **API連携の実装:**
      - `EmojiGenerator.tsx`内で、生成ボタンがクリックされたら`fetch` APIを使ってバックエンドにリクエストを送信します。
      - レスポンスとして受け取った画像を使用します。
5. **テストとリファクタリング:**
      - APIとフロントエンドが仕様通りに連携して動作することを確認します。
      - コード全体の可読性やパフォーマンスをレビューし、改善します。
